
/*************************************************************************  
* 프로시저명: dbo.UP_DBA_GMARKET_TRANS_MASTER
* 작성정보	: 2014-09-25 BY CHOI BO RA  서버간의 이관 정책 가져오기
* 관련페이지:  
* 내용		: 

* 수정정보	: 
**************************************************************************/
ALTER  PROCEDURE dbo.UP_DBA_GMARKET_TRANS_MASTER
AS

/* COMMON DECLARE */
SET NOCOUNT ON

/* USER DECLARE  */

/*BODY*/
SELECT 1 AS SERVER_ID, C.FROM_SERVER, C.FROM_DB, C.FROM_TABLE, 	
	C.TO_SERVER, C.TO_DB, C.TO_TABLE, 
	CONVERT(VARCHAR(1),ISNULL(UPPER(C.USE_YN), 'Y') )AS USE_YN, CASE WHEN C.TO_SERVER IS NULL THEN 'D' ELSE 'T'  END AS WORK_TYPE, 'M' AS PERIOD_TYPE, C.PERIOD , 
	C.TRANS_COLUMN, C.PARTITION_YN, 'Y' AS SSIS_YN, 
	CONVERT(NVARCHAR(500),C.PACKAGE_NAME )AS JOB_NAME, CONVERT(VARCHAR(30),C.mgr_name) AS MGR_NAME, CONVERT(VARCHAR(20), C.MGR_TEAM) AS MGR_TEAM,
	CONVERT(NVARCHAR(500),C.EXCEPTION_SQL) AS COMMENT,  'N' AS LOCAL_JOB_YN,
	C.REG_DT, C.CHG_DT, 'DB_JOB' AS REG_ID, 'DB_JOB' AS CHG_ID , 
	C.LAST_TRANS_VALUE AS LAST_TRANS_DATE,
	C.SEQ_NO AS REF_SEQ_NO, C.P_SEQ_NO AS REF_P_SEQ_NO
FROM TRANS_MASTER  AS P WITH(NOLOCK) 
	JOIN TRANS_MASTER AS C WITH(NOLOCK) ON  P.seq_no = C.p_seq_no
ORDER BY C.P_SEQ_NO, C.SEQ_NO, C.FROM_SERVER, C.FROM_DB, C.FROM_TABLE


